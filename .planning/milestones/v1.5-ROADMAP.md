# Roadmap: v1.5 Org Onboarding & Co-working

## Overview

Enable organizations to self-onboard to ASTN through an application and approval flow, then configure and operate co-working spaces where members book desks, guests apply for visits, and admins track utilization. This milestone adds the physical-space layer to ASTN's digital talent network, turning it from a matching platform into a daily operating tool for AI safety hubs.

## Phases

**Phase Numbering:** Continues from v1.4 Hardening (phases 27-29).

- [x] **Phase 30: Platform Admin + Org Application** - Orgs can apply to join ASTN and platform admins can approve them
- [ ] **Phase 31: Org Self-Configuration + Space Definition** - Approved orgs configure themselves and define their co-working space
- [ ] **Phase 32: Member Booking + Consent + Attendee View** - Members book daily co-working spots and see who else is coming
- [ ] **Phase 33: Guest Access + Visit Applications** - Non-members create lightweight accounts and apply to visit
- [ ] **Phase 34: Admin Dashboard + Stats** - Org admins manage bookings, review guests, and track utilization

## Phase Details

### Phase 30: Platform Admin + Org Application

**Goal:** Organizations can apply to join ASTN, and platform admins can review, approve, or reject applications -- establishing the trust gate for the network.

**Depends on:** Nothing (first phase of v1.5; builds on existing auth and org infrastructure from v1.0-v1.4)

**Requirements:** ORGON-01, ORGON-02, ORGON-03, ORGON-04, ORGON-05, ORGON-06

**Success Criteria** (what must be TRUE):
1. An unauthenticated or authenticated user can submit an org application with name, description, city/country, website, contact person, and reason for joining
2. A platform admin can view all pending applications in a review queue and approve or reject each with a reason
3. An approved applicant receives a notification with a link to configure their org; a rejected applicant sees the rejection reason
4. An applicant can check their application status (pending/approved/rejected) at a stable URL at any time
5. Submitting an application for an org that already exists or has a pending application is prevented with a clear message

**Plans:**
- 30-01: Schema + Auth + Org Applications Backend (6 tasks)
- 30-02: Frontend — Application Form, Status Page, Admin Review Queue (8 tasks)

**Key implementation notes from research:**
- New `platformAdmins` table with `requirePlatformAdmin` helper -- must be cleanly separated from `requireOrgAdmin`
- New `orgApplications` table with explicit state machine (pending/approved/rejected/withdrawn)
- Approval mutation creates the org record + orgMembership for the applicant as admin
- Duplicate detection on org name and/or domain
- Mirrors existing `programParticipation` status workflow pattern
- No new dependencies required

---

### Phase 31: Org Self-Configuration + Space Definition

**Goal:** Approved orgs complete setup (logo, description, invite links) and define their co-working space (capacity, hours, custom guest application fields) so members and guests can start booking.

**Depends on:** Phase 30 (org must exist and have an admin)

**Requirements:** ORGON-07, ORGON-08, ORGON-09, COWRK-01

**Success Criteria** (what must be TRUE):
1. An approved org admin can complete a self-configuration wizard setting logo, description, and generating an invite link
2. The org admin sees a progressive onboarding checklist showing which setup steps are complete and which remain
3. The org admin can bulk-invite initial members by entering multiple email addresses
4. The org admin can configure a co-working space with name, capacity, operating hours per day-of-week, and timezone

**Key implementation notes from research:**
- New `coworkingSpaces` table with capacity, operating hours (minutes-from-midnight per day-of-week), IANA timezone, custom visit application fields (JSON schema), guest access toggle
- Extend `organizations` table with optional `contactEmail`, `website`, `socialLinks`, `hasCoworkingSpace` fields
- Operating hours stored as minutes-from-midnight to avoid timezone conversion bugs
- Custom visit application fields use template approach: predefined field types (text, textarea, select, checkbox)
- Onboarding checklist is computed from org + space field completeness, not a separate table
- No new npm dependencies

**Plans:** TBD

---

### Phase 32: Member Booking + Consent + Attendee View

**Goal:** Members can book a co-working spot for any day with flexible hours, see who else is booked (with consent-based profile visibility), and manage their upcoming bookings.

**Depends on:** Phase 31 (space must be configured with capacity and hours)

**Requirements:** COWRK-02, COWRK-03, COWRK-04, COWRK-05, COWRK-06, COWRK-07, COWRK-08

**Success Criteria** (what must be TRUE):
1. A member can pick a date from a calendar (showing per-day availability), select flexible hours (e.g., "10am-3pm"), and book a spot
2. The booking page shows current capacity with a soft warning when the space is nearing full, without blocking the booking
3. A member can view their today and upcoming bookings, cancel any booking, and optionally add a "working on" or "interested in meeting" tag
4. A member can see the list of other people booked for the same day, with profile previews, because booking constitutes consent to share a booking profile subset
5. The calendar date picker visually indicates which days have availability and which are near or at capacity

**Key implementation notes from research:**
- New `spaceBookings` table with ISO date strings, time ranges as minutes-from-midnight, booking type (member/guest), status, consent flag
- Install `react-day-picker` (the only new npm dependency in v1.5) for calendar UI
- Capacity checks + booking inserts in single Convex mutation (transactional, no race conditions)
- Soft capacity: mutations return warnings, never throw errors on full spaces
- Consent model: booking = consent to share booking profile (name + headline + skills). Separate from general profile privacy settings. Consent stored per booking.
- Dedicated `bookingProfile` query returns only the consented subset of profile data

**Plans:** TBD

---

### Phase 33: Guest Access + Visit Applications

**Goal:** Non-members can create a lightweight guest account, apply to visit a specific org on a specific day using the org's custom form, get approved or rejected by the org admin, and have their visit info pre-fill an ASTN profile if they later sign up.

**Depends on:** Phase 32 (booking infrastructure must exist; guest bookings use same spaceBookings table)

**Requirements:** GUEST-01, GUEST-02, GUEST-03, GUEST-04, GUEST-05, GUEST-06, GUEST-07, GUEST-08, GUEST-09, GUEST-10

**Success Criteria** (what must be TRUE):
1. A non-member can create a guest account with just name and email (minimal friction), then fill out the org's custom visit application form for a specific day
2. An org admin can approve or reject guest visit applications (individually or in batch) with an optional message, and the guest receives email and in-app notification of the decision
3. Approved guests appear alongside members on that day's attendee view with the same consent-based profile visibility
4. An org can share a public visit request page (e.g., `/org/baish/visit`) that non-members can use to apply without prior account creation
5. Guest visit info (name, email, application responses) pre-fills ASTN profile fields if the guest later creates a full account

**Key implementation notes from research:**
- New `guestProfiles` table with name, email, organization, role, `hasFullProfile` conversion tracking
- Guest accounts use real `@convex-dev/auth` Password accounts (not Anonymous provider) for persistent identity and notifications
- Guests must NOT trigger engagement scoring, match computation, or appear in CRM member lists -- audit all existing `auth.getUserId()` call sites
- Custom visit application form fields come from `coworkingSpaces` config (defined in Phase 31)
- Guest-to-member conversion links by email; pre-fill mapping defined explicitly
- GUEST-02 (custom form fields) was defined in Phase 31's space config; Phase 33 renders and submits them
- 7 new notification types for visit application lifecycle

**Plans:** TBD

---

### Phase 34: Admin Dashboard + Stats

**Goal:** Org admins have a dedicated dashboard to see today's bookings, browse upcoming and historical bookings, manage the guest application queue, view utilization stats, and export data.

**Depends on:** Phase 33 (guest data must exist for guest-related admin views; all booking types must be in place)

**Requirements:** ADMIN-01, ADMIN-02, ADMIN-03, ADMIN-04, ADMIN-05, ADMIN-06, ADMIN-07, ADMIN-08, ADMIN-09

**Success Criteria** (what must be TRUE):
1. An org admin sees a today's-bookings overview showing all members and approved guests, and can browse upcoming bookings in calendar or list view
2. An org admin has a dedicated guest application review queue (separate from inline notification approval) with batch operations
3. An org admin can view booking history with date range filtering, manually add or remove bookings on behalf of members, and configure space settings (capacity, hours, custom guest form)
4. An org admin sees utilization statistics including weekly/monthly rates, peak days, average bookings, and guest conversion tracking (guests who became members)
5. An org admin can export booking data as CSV

**Key implementation notes from research:**
- Reuses existing stat card and CSV export patterns from CRM dashboard
- Calendar view uses react-day-picker (installed in Phase 32)
- ADMIN-05 (space settings) is the ongoing admin management view for what Phase 31 creates in the wizard
- ADMIN-03 (guest queue) is the dedicated dashboard view; Phase 33 delivers the approval mutations
- Date-scoped queries to prevent dashboard overload
- Guest conversion tracking: count `guestProfiles` where `hasFullProfile = true` per org
- Separate tab/section for space management within existing org admin dashboard

**Plans:** TBD

---

## Coverage

| Requirement | Phase | Description |
|-------------|-------|-------------|
| ORGON-01 | 30 | Org application submission |
| ORGON-02 | 30 | Platform admin review queue |
| ORGON-03 | 30 | Approve/reject with reason |
| ORGON-04 | 30 | Notification to applicant |
| ORGON-05 | 30 | Application status page |
| ORGON-06 | 30 | Duplicate org detection |
| ORGON-07 | 31 | Self-configuration wizard |
| ORGON-08 | 31 | Onboarding checklist |
| ORGON-09 | 31 | Bulk-invite members |
| COWRK-01 | 31 | Space configuration |
| COWRK-02 | 32 | Book spot with flexible hours |
| COWRK-03 | 32 | Capacity with soft warnings |
| COWRK-04 | 32 | Cancel own bookings |
| COWRK-05 | 32 | See who else is booked |
| COWRK-06 | 32 | Personal booking view |
| COWRK-07 | 32 | Calendar availability |
| COWRK-08 | 32 | Working-on / meeting tag |
| GUEST-01 | 33 | Lightweight guest account |
| GUEST-02 | 33 | Custom visit application fields |
| GUEST-03 | 33 | Guest fills application form |
| GUEST-04 | 33 | Admin approve/reject visits |
| GUEST-05 | 33 | Guest visit notifications |
| GUEST-06 | 33 | Guests on attendee view |
| GUEST-07 | 33 | Public visit request page |
| GUEST-08 | 33 | Guest info pre-fills profile |
| GUEST-09 | 33 | Guest visit history |
| GUEST-10 | 33 | Batch-approve guests |
| ADMIN-01 | 34 | Today's bookings overview |
| ADMIN-02 | 34 | Upcoming bookings calendar/list |
| ADMIN-03 | 34 | Guest application queue |
| ADMIN-04 | 34 | Booking history with filtering |
| ADMIN-05 | 34 | Configure space settings |
| ADMIN-06 | 34 | Manual booking management |
| ADMIN-07 | 34 | Utilization statistics |
| ADMIN-08 | 34 | Guest conversion tracking |
| ADMIN-09 | 34 | CSV export |

**Mapped: 36/36 -- no orphans, no duplicates.**

## Progress

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 30. Platform Admin + Org Application | 2/2 | ✅ Complete | 2026-02-03 |
| 31. Org Self-Configuration + Space Definition | 0/TBD | Not started | - |
| 32. Member Booking + Consent + Attendee View | 0/TBD | Not started | - |
| 33. Guest Access + Visit Applications | 0/TBD | Not started | - |
| 34. Admin Dashboard + Stats | 0/TBD | Not started | - |

---

_Roadmap created: 2026-02-03_
_Milestone: v1.5 Org Onboarding & Co-working_
