---
phase: 01-foundation-opportunities
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - convex/schema.ts
  - convex/_generated/*
  - src/app/layout.tsx
  - src/app/ConvexClientProvider.tsx
  - src/app/page.tsx
  - src/lib/utils.ts
  - tailwind.config.ts
  - components.json
  - .env.local
autonomous: false

must_haves:
  truths:
    - "Running `pnpm dev` starts development server without errors"
    - "Visiting localhost:3000 renders a page"
    - "Convex dashboard shows connected project"
    - "TypeScript compiles without errors"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies"
      contains: "convex"
    - path: "convex/schema.ts"
      provides: "Database schema placeholder"
      min_lines: 5
    - path: "src/app/layout.tsx"
      provides: "Root layout with providers"
      contains: "ClerkProvider"
    - path: "src/app/ConvexClientProvider.tsx"
      provides: "Convex client setup"
      contains: "ConvexProviderWithClerk"
  key_links:
    - from: "src/app/layout.tsx"
      to: "src/app/ConvexClientProvider.tsx"
      via: "import and render"
      pattern: "ConvexClientProvider"
---

<objective>
Set up the project foundation: Next.js 16 with App Router, Convex backend, Clerk auth provider stubs, Tailwind CSS, and shadcn/ui component library.

Purpose: Establish the technical foundation that all subsequent plans build upon. Without this, no other work can proceed.

Output: A working Next.js + Convex project with proper provider setup, ready for feature development.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-opportunities/CONTEXT.md
@.planning/phases/01-foundation-opportunities/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Next.js project with dependencies</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    .gitignore
  </files>
  <action>
Create Next.js 16 project in current directory (not a subdirectory):

```bash
pnpm create next-app@latest . --typescript --tailwind --eslint --app --src-dir --import-alias "@/*" --turbopack
```

If directory not empty, the scaffolder may fail. In that case, create in temp dir and move files.

After scaffolding, install additional dependencies:

```bash
pnpm add convex @clerk/nextjs
pnpm add class-variance-authority clsx tailwind-merge lucide-react
pnpm add -D @types/node
```

These are the core dependencies. Phase-specific dependencies (algoliasearch, playwright, string-similarity) will be added in later plans when needed.
  </action>
  <verify>
`pnpm install` completes without errors.
`ls src/app` shows page.tsx and layout.tsx exist.
  </verify>
  <done>Next.js project scaffolded with all core dependencies installed.</done>
</task>

<task type="auto">
  <name>Task 2: Configure Convex and Clerk providers</name>
  <files>
    convex/schema.ts
    src/app/layout.tsx
    src/app/ConvexClientProvider.tsx
    src/lib/utils.ts
    .env.local
  </files>
  <action>
1. Initialize Convex:
```bash
pnpm convex dev
```
This will prompt to create a new project or link existing. Create new project named "astn" (or similar). This generates `convex/_generated/` and adds CONVEX_URL to .env.local.

2. Create minimal schema placeholder at `convex/schema.ts`:
```typescript
import { defineSchema, defineTable } from "convex/server";
import { v } from "convex/values";

// Placeholder - will be populated in 01-02
export default defineSchema({});
```

3. Create `src/app/ConvexClientProvider.tsx`:
```typescript
"use client";
import { ConvexReactClient } from "convex/react";
import { ConvexProviderWithClerk } from "convex/react-clerk";
import { useAuth } from "@clerk/nextjs";
import { ReactNode } from "react";

const convex = new ConvexReactClient(process.env.NEXT_PUBLIC_CONVEX_URL!);

export function ConvexClientProvider({ children }: { children: ReactNode }) {
  return (
    <ConvexProviderWithClerk client={convex} useAuth={useAuth}>
      {children}
    </ConvexProviderWithClerk>
  );
}
```

4. Update `src/app/layout.tsx` to wrap with providers (ClerkProvider outside, ConvexClientProvider inside):
```typescript
import { ClerkProvider } from "@clerk/nextjs";
import { ConvexClientProvider } from "./ConvexClientProvider";
import "./globals.css";

export default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <ClerkProvider>
      <html lang="en">
        <body>
          <ConvexClientProvider>{children}</ConvexClientProvider>
        </body>
      </html>
    </ClerkProvider>
  );
}
```

5. Create `src/lib/utils.ts` with cn helper:
```typescript
import { type ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

6. Add placeholder Clerk keys to `.env.local` (user will replace with real keys):
```
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_placeholder
CLERK_SECRET_KEY=sk_test_placeholder
```

IMPORTANT: Provider order matters. ClerkProvider must wrap ConvexProviderWithClerk. See research doc Pattern 6 warning about this common pitfall.
  </action>
  <verify>
`pnpm convex dev` shows "Convex functions ready" (run in separate terminal).
`grep -r "ConvexProviderWithClerk" src/` returns the provider file.
  </verify>
  <done>Convex connected to cloud project, providers configured in correct nesting order.</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 3: Configure Clerk application</name>
  <action>
User must create Clerk application and add real API keys.

1. Go to https://dashboard.clerk.com
2. Create new application (or use existing)
3. Copy the publishable key and secret key
4. Update `.env.local`:
   - Replace `pk_test_placeholder` with real `NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY`
   - Replace `sk_test_placeholder` with real `CLERK_SECRET_KEY`
  </action>
  <how-to-verify>
After adding keys, run `pnpm dev` and visit http://localhost:3000. Page should load without Clerk errors in console.
  </how-to-verify>
  <resume-signal>Type "keys configured" when Clerk API keys are added to .env.local</resume-signal>
</task>

<task type="auto">
  <name>Task 4: Initialize shadcn/ui and create landing page</name>
  <files>
    components.json
    src/components/ui/button.tsx
    src/components/ui/card.tsx
    src/app/page.tsx
  </files>
  <action>
1. Initialize shadcn/ui:
```bash
pnpm dlx shadcn@latest init
```
When prompted:
- Style: Default
- Base color: Slate (warm, approachable per CONTEXT.md)
- CSS variables: Yes

2. Add initial components needed for opportunity cards:
```bash
pnpm dlx shadcn@latest add button card badge input
```

3. Replace `src/app/page.tsx` with a simple landing page:
```typescript
import { Button } from "@/components/ui/button";
import Link from "next/link";

export default function Home() {
  return (
    <main className="min-h-screen bg-gradient-to-b from-slate-50 to-slate-100">
      <div className="container mx-auto px-4 py-16">
        <div className="max-w-2xl mx-auto text-center">
          <h1 className="text-4xl font-bold text-slate-900 mb-4">
            AI Safety Talent Network
          </h1>
          <p className="text-lg text-slate-600 mb-8">
            Find opportunities in AI safety research, policy, and engineering.
          </p>
          <Button asChild size="lg">
            <Link href="/opportunities">Browse Opportunities</Link>
          </Button>
        </div>
      </div>
    </main>
  );
}
```

This gives us a working homepage with the warm, approachable aesthetic defined in CONTEXT.md.
  </action>
  <verify>
`ls src/components/ui/` shows button.tsx, card.tsx, badge.tsx, input.tsx exist.
`pnpm dev` and visit http://localhost:3000 shows styled landing page.
  </verify>
  <done>shadcn/ui configured, base components installed, landing page renders with project branding.</done>
</task>

</tasks>

<verification>
Run these commands to verify plan completion:

```bash
# TypeScript compiles
pnpm tsc --noEmit

# Dev server starts
pnpm dev
# Visit http://localhost:3000 - should show landing page

# Convex connected (in separate terminal)
pnpm convex dev
# Should show "Convex functions ready"

# All expected files exist
ls convex/schema.ts
ls src/app/ConvexClientProvider.tsx
ls src/components/ui/button.tsx
```
</verification>

<success_criteria>
- Next.js dev server runs without errors
- Landing page renders at localhost:3000
- Convex dashboard shows connected project with schema
- TypeScript compiles without errors
- shadcn/ui components available for use
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-opportunities/01-01-SUMMARY.md`
</output>
