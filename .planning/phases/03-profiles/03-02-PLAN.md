---
phase: 03-profiles
plan: 02
type: execute
wave: 2
depends_on: ['03-01']
files_modified:
  - convex/skills.ts
  - src/components/profile/wizard/steps/SkillsStep.tsx
  - src/components/profile/skills/SkillsInput.tsx
  - src/components/profile/skills/SkillChip.tsx
autonomous: true

must_haves:
  truths:
    - 'User can see skills from AI safety taxonomy as they type'
    - 'User can select skills from taxonomy suggestions'
    - 'User can add custom skills not in taxonomy'
    - 'User can remove selected skills'
    - 'User sees soft limit guidance at 10+ skills'
    - 'Skills persist to profile after selection'
  artifacts:
    - path: 'convex/skills.ts'
      provides: 'Skills taxonomy queries and seed data'
      exports: ['getTaxonomy', 'searchSkills']
    - path: 'src/components/profile/wizard/steps/SkillsStep.tsx'
      provides: 'Skills selection wizard step'
      min_lines: 30
    - path: 'src/components/profile/skills/SkillsInput.tsx'
      provides: 'Tag input with autocomplete'
      min_lines: 50
  key_links:
    - from: 'SkillsStep.tsx'
      to: 'SkillsInput'
      via: 'component composition'
      pattern: 'SkillsInput'
    - from: 'SkillsInput.tsx'
      to: 'convex/skills.ts'
      via: 'useQuery for taxonomy'
      pattern: 'useQuery.*getTaxonomy|searchSkills'
    - from: 'SkillsInput.tsx'
      to: 'useAutoSave'
      via: 'saving skills array to profile'
      pattern: 'saveField.*skills'
---

<objective>
Implement skills taxonomy and selection UI with tag-based input

Purpose: Enable users to select AI safety-relevant skills from a curated taxonomy while also allowing custom skill entry. Skills are displayed as chips and saved to the user's profile.

Output:

- Skills taxonomy seed data in Convex
- Fully functional SkillsStep replacing the placeholder
- Tag input component with autocomplete suggestions
- Skill chips with remove capability
  </objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-profiles/03-CONTEXT.md
@.planning/phases/03-profiles/03-RESEARCH.md
@.planning/phases/03-profiles/03-01-SUMMARY.md

Key decisions from CONTEXT.md:

- Freeform input with taxonomy suggestions
- Tag-based chips UI (like GitHub topics)
- Soft limit with guidance ("pick your top 10")

Skills taxonomy categories from RESEARCH.md:

- Research Areas (Alignment, Interpretability, Governance, etc.)
- Technical Skills (ML Engineering, NLP, RL, Python/PyTorch/JAX, etc.)
- Domain Knowledge (AI Risk, Ethics, Policy, etc.)
- Soft Skills (Technical Writing, Research Communication, etc.)
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Skills taxonomy seed data and queries</name>
  <files>
    - convex/skills.ts
  </files>
  <action>
Create convex/skills.ts with:

1. **Seed data array** with AI safety skills taxonomy:

Research Areas:

- Alignment Research
- Interpretability / Mechanistic Interpretability
- AI Governance and Policy
- AI Safety Evaluation
- Robustness and Security
- Multi-Agent Safety
- Scalable Oversight
- Value Learning / RLHF
- Deceptive Alignment Detection
- Constitutional AI
- Red Teaming

Technical Skills:

- Machine Learning Engineering
- Deep Learning / Neural Networks
- Natural Language Processing
- Reinforcement Learning
- Python
- PyTorch
- JAX
- TensorFlow
- Statistical Analysis
- Formal Verification
- Causal Inference

Domain Knowledge:

- AI Risk Assessment
- Existential Risk
- AI Ethics
- Technology Policy
- International Coordination
- Regulatory Frameworks

Soft Skills:

- Technical Writing
- Research Communication
- Cross-functional Collaboration
- Stakeholder Engagement
- Project Management

2. **seedTaxonomy mutation** (internal):

- Insert all skills into skillsTaxonomy table if not already present
- Use skill name as unique identifier

3. **getTaxonomy query**:

- Return all skills from skillsTaxonomy table
- Order by category, then name

4. **searchSkills query**:

- Args: { query: string }
- Search skills by name using searchIndex
- Also match aliases if present
- Return matching skills with category

5. **ensureTaxonomySeeded action** (called on first access):

- Check if taxonomy has entries
- If empty, call seedTaxonomy
- This allows lazy initialization without migration scripts
  </action>
  <verify>
  Run `npx convex dev` - compiles without errors
  Call getTaxonomy in Convex dashboard - returns empty (not seeded yet)
  Call ensureTaxonomySeeded - populates table
  Call getTaxonomy again - returns all skills with categories
  Call searchSkills with "alignment" - returns matching skills
  </verify>
  <done>
  Skills taxonomy seeded in Convex. getTaxonomy returns ~30 skills across 4 categories. searchSkills filters by query string.
  </done>
  </task>

<task type="auto">
  <name>Task 2: SkillsStep with tag input and autocomplete</name>
  <files>
    - src/components/profile/wizard/steps/SkillsStep.tsx
    - src/components/profile/skills/SkillsInput.tsx
    - src/components/profile/skills/SkillChip.tsx
  </files>
  <action>
**Component: SkillChip.tsx**
- Props: skill (string), onRemove callback
- Render as inline-flex pill/chip with coral-100 background, coral-800 text
- X button to remove (calls onRemove)
- Hover state with slightly darker background

**Component: SkillsInput.tsx**

- Props: selectedSkills (string[]), onSkillsChange (callback), maxSuggested (default 10)
- Internal state: input value, showSuggestions boolean
- Fetch taxonomy via useQuery(api.skills.getTaxonomy)
- Trigger ensureTaxonomySeeded on mount if taxonomy is empty
- Filter taxonomy based on input (case-insensitive contains)
- Exclude already-selected skills from suggestions
- Show suggestions dropdown when input focused and has text
- Click suggestion or press Enter to add skill
- Show selected skills as SkillChip components above input
- Soft limit: show amber warning at 10+ skills ("Consider focusing on your top 10")
- Allow custom skills not in taxonomy (Enter on non-match adds as custom)

UI structure:

```
[Selected skills as chips]

[Input field with placeholder "Type to search skills..."]

[Suggestions dropdown when typing]
  - Each suggestion shows: skill name + category badge
  - Keyboard navigation (up/down arrows, Enter to select)
```

**Component: SkillsStep.tsx (replace placeholder)**

- Fetch profile via getOrCreateProfile
- Get useAutoSave hook
- Render heading: "Skills" with subtext about AI safety skills
- Render SkillsInput with profile.skills as selectedSkills
- onSkillsChange: call saveField('skills', newSkills)
- Show "Skip for now" and Next/Previous navigation (use wizard props)

Styling:

- Use Radix Popover or simple absolute positioning for suggestions dropdown
- Suggestions list: max-height with overflow-y-auto
- Focus ring on input using existing focus styles
- Smooth transitions on chip hover/remove
  </action>
  <verify>

1. Navigate to Skills step in wizard
2. Type "alignment" - see "Alignment Research" in suggestions
3. Click suggestion - skill added as chip, input clears
4. Add 10+ skills - see soft limit warning
5. Type custom skill, press Enter - added even if not in taxonomy
6. Click X on chip - skill removed
7. Navigate away and back - skills persist
8. Refresh page - skills still there
   </verify>
   <done>
   SkillsStep fully functional with tag input. Users can select from taxonomy or add custom skills. Skills persist to profile. Soft limit guidance shown at 10+ skills.
   </done>
   </task>

</tasks>

<verification>
- [ ] Skills taxonomy seeded (30+ skills across 4 categories)
- [ ] SkillsStep no longer shows placeholder
- [ ] Typing shows autocomplete suggestions from taxonomy
- [ ] Can select skills by clicking suggestions
- [ ] Can add custom skills via Enter key
- [ ] Selected skills appear as removable chips
- [ ] Soft limit warning appears at 10+ skills
- [ ] Skills persist to profile after leaving step
- [ ] Keyboard navigation works (arrows + Enter)
</verification>

<success_criteria>

1. Taxonomy seeded with AI safety-specific skills
2. User can search and select skills from taxonomy
3. User can add custom skills not in taxonomy
4. User can remove selected skills
5. Soft limit guidance shows at 10+ skills
6. Skills save to profile and persist across refresh
   </success_criteria>

<output>
After completion, create `.planning/phases/03-profiles/03-02-SUMMARY.md`
</output>
