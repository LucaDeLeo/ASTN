---
phase: 19-motion-system
plan: 02
type: execute
wave: 2
depends_on: ['19-01']
files_modified:
  - src/components/matches/MatchTierSection.tsx
  - src/routes/index.tsx
  - src/router.tsx
  - src/styles/app.css
autonomous: true
user_setup: []

must_haves:
  truths:
    - 'Match cards stagger in when MatchTierSection renders'
    - 'Home page event cards stagger in when Dashboard renders'
    - 'Page transitions provide smooth crossfade when navigating'
  artifacts:
    - path: 'src/components/matches/MatchTierSection.tsx'
      provides: 'Match cards with staggered entrance animation'
      contains: 'AnimatedCard'
    - path: 'src/routes/index.tsx'
      provides: 'Dashboard with staggered event cards'
      contains: 'AnimatedCard'
    - path: 'src/router.tsx'
      provides: 'Router with view transitions enabled'
      contains: 'defaultViewTransition'
    - path: 'src/styles/app.css'
      provides: 'View transition CSS rules'
      contains: '::view-transition'
  key_links:
    - from: 'src/components/matches/MatchTierSection.tsx'
      to: 'src/components/animation/AnimatedCard.tsx'
      via: 'import statement'
      pattern: 'import.*AnimatedCard'
    - from: 'src/router.tsx'
      to: 'View Transitions API'
      via: 'defaultViewTransition option'
      pattern: 'defaultViewTransition.*true'
---

<objective>
Apply animation components to list pages and enable page transitions.

Purpose: Brings the motion system to life across the app - staggered card entrances create visual rhythm on list pages, and page transitions provide continuity when navigating.

Output: MatchTierSection with staggered cards, Dashboard with staggered event cards, router with view transitions, CSS for transition styling.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-motion-system/19-01-SUMMARY.md
@.planning/phases/19-motion-system/19-RESEARCH.md

# Components to update

@src/components/matches/MatchTierSection.tsx
@src/routes/index.tsx
@src/router.tsx
@src/styles/app.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add staggered animations to MatchTierSection</name>
  <files>src/components/matches/MatchTierSection.tsx</files>
  <action>
Update `src/components/matches/MatchTierSection.tsx` to use AnimatedCard for staggered entrance.

1. Import AnimatedCard from the animation folder:
   `import { AnimatedCard } from "~/components/animation/AnimatedCard";`

2. In the grid mapping, wrap each MatchCard with AnimatedCard:
   ```tsx
   {
     matches.map((match, index) => (
       <AnimatedCard key={match._id} index={index}>
         <MatchCard match={match} />
       </AnimatedCard>
     ))
   }
   ```

This ensures match cards stagger in when the section renders, providing visual rhythm as the user views their matches.
</action>
<verify>MatchTierSection imports AnimatedCard and wraps MatchCard instances. Cards stagger on page load.</verify>
<done>Match cards in all tiers (great, good, exploring) animate in with stagger delay</done>
</task>

<task type="auto">
  <name>Task 2: Add staggered animations to Dashboard event cards</name>
  <files>src/routes/index.tsx</files>
  <action>
Update `src/routes/index.tsx` (Dashboard) to use AnimatedCard for staggered event card entrance.

1. Import AnimatedCard:
   `import { AnimatedCard } from "~/components/animation/AnimatedCard";`

2. In the Dashboard function, find the event cards mapping in the "Upcoming Events" section.

3. There are two places where EventCard is mapped:
   a. User org events (inside eventsByOrg map)
   b. Other org events (discover events)

4. Wrap each EventCard with AnimatedCard. Use a running index across all events for smooth stagger:

   For user org events:

   ```tsx
   {
     events.slice(0, 5).map((event, index) => (
       <AnimatedCard key={event._id} index={index}>
         <EventCard event={event} />
       </AnimatedCard>
     ))
   }
   ```

   For other org events:

   ```tsx
   {
     dashboardEvents.otherOrgEvents.slice(0, 3).map((event, index) => (
       <AnimatedCard key={event._id} index={index}>
         <EventCard event={event} />
       </AnimatedCard>
     ))
   }
   ```

Note: OrgCarousel already has its own animation, so leave that unchanged.
</action>
<verify>Dashboard imports AnimatedCard. EventCard instances are wrapped. Events stagger on page load.</verify>
<done>Dashboard event cards animate in with stagger delay when section renders</done>
</task>

<task type="auto">
  <name>Task 3: Enable view transitions in router and add CSS</name>
  <files>src/router.tsx, src/styles/app.css</files>
  <action>
Enable browser-native View Transitions API for page navigation.

**Part A: Update src/router.tsx**

In the createRouter options, add `defaultViewTransition: true`:

```tsx
const router = routerWithQueryClient(
  createRouter({
    routeTree,
    defaultPreload: 'intent',
    context: { queryClient },
    scrollRestoration: true,
    defaultPreloadStaleTime: 0,
    defaultViewTransition: true, // ADD THIS LINE
    defaultErrorComponent: (err) => <p>{err.error.stack}</p>,
    defaultNotFoundComponent: () => <p>not found</p>,
    Wrap: ({ children }) => (
      <ConvexAuthProvider client={convexQueryClient.convexClient}>
        {children}
      </ConvexAuthProvider>
    ),
  }),
  queryClient,
)
```

**Part B: Add view transition CSS to src/styles/app.css**

Add after the reduced motion section (at the end of the file):

```css
/* ==========================================================================
   VIEW TRANSITIONS - Smooth crossfade between pages
   ========================================================================== */
::view-transition-old(root),
::view-transition-new(root) {
  animation-duration: var(--duration-normal);
  animation-timing-function: var(--ease-gentle);
}

/* Reduce motion: instant transition, no animation */
@media (prefers-reduced-motion: reduce) {
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation: none !important;
  }
}
```

This provides a subtle crossfade (250ms with gentle easing) when navigating between routes. The View Transitions API handles the snapshot and animation automatically.
</action>
<verify>Router has defaultViewTransition: true. app.css has ::view-transition rules. Navigation shows smooth crossfade.</verify>
<done>Page transitions use View Transitions API with 250ms crossfade and respect reduced motion preference</done>
</task>

</tasks>

<verification>
1. MatchTierSection wraps MatchCard with AnimatedCard
2. Dashboard wraps EventCard with AnimatedCard
3. Router has defaultViewTransition: true
4. app.css has ::view-transition-old and ::view-transition-new rules
5. Navigating between pages shows smooth crossfade
6. `bun run lint` passes
7. prefers-reduced-motion disables view transition animations
</verification>

<success_criteria>

- Match cards stagger in on /matches page
- Event cards stagger in on home dashboard
- Page navigation has smooth crossfade transition
- All animations respect reduced motion preference
- No TypeScript or lint errors
  </success_criteria>

<output>
After completion, create `.planning/phases/19-motion-system/19-02-SUMMARY.md`
</output>
